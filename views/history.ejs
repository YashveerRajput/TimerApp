<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>History - Focus Timer</title>
  
  <!-- Google Fonts - Inter -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <style>
    * {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    }
    
    body {
      background: #000;
      color: #fff;
    }
    
    .glass-card {
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .smooth-transition {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .btn-hover:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(255, 255, 255, 0.1);
    }
    
    .btn-hover:active {
      transform: translateY(0);
    }
    
    .session-card {
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid rgba(255, 255, 255, 0.08);
    }
    
    .session-card:hover {
      background: rgba(255, 255, 255, 0.06);
      border-color: rgba(255, 255, 255, 0.15);
    }
  </style>
</head>
<body class="min-h-screen p-8">
  
  <!-- Header -->
  <div class="max-w-4xl mx-auto mb-8">
    <div class="flex items-center justify-between">
      <h1 class="text-4xl font-light">Session History</h1>
      <a href="/" class="glass-card px-6 py-2.5 rounded-2xl text-sm smooth-transition btn-hover">
        ‚Üê Back to Timer
      </a>
    </div>
  </div>

  <!-- Sessions List -->
  <div class="max-w-4xl mx-auto space-y-4">
    
    <% if (sessions.length === 0) { %>
      <div class="glass-card rounded-3xl p-12 text-center">
        <p class="text-xl text-white/60">No sessions saved yet</p>
        <p class="text-sm text-white/40 mt-2">Start a timer or stopwatch to save your first session</p>
      </div>
    <% } else { %>
      
      <% sessions.forEach(session => { %>
        <div class="session-card rounded-3xl p-6 smooth-transition">
          <div class="flex items-start justify-between">
            
            <!-- Session Info -->
            <div class="flex-1">
              <div class="flex items-center gap-3 mb-2">
                <span class="glass-card px-3 py-1 rounded-xl text-xs font-medium uppercase">
                  <%= session.type %>
                </span>
                <span class="text-2xl font-light font-mono">
                  <%= session.duration %>
                </span>
              </div>
              
              <p class="text-sm text-white/50">
                <%= new Date(session.createdAt).toLocaleString('en-US', { 
                  year: 'numeric', 
                  month: 'short', 
                  day: 'numeric', 
                  hour: '2-digit', 
                  minute: '2-digit' 
                }) %>
              </p>
              
              <!-- Laps (if stopwatch) -->
              <% if (session.type === 'stopwatch' && session.laps && session.laps.length > 0) { %>
                <div class="mt-4 space-y-1">
                  <p class="text-xs text-white/60 mb-2">Laps:</p>
                  <% session.laps.forEach((lap, index) => { %>
                    <div class="text-sm text-white/70 font-mono">
                      Lap <%= index + 1 %>: <%= lap %>
                    </div>
                  <% }) %>
                </div>
              <% } %>
            </div>

            <!-- Delete Button -->
            <button onclick="deleteSession('<%= session._id %>')" 
                    class="glass-card p-3 rounded-xl smooth-transition btn-hover text-red-400 hover:text-red-300">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                      d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
              </svg>
            </button>

          </div>
        </div>
      <% }) %>
      
    <% } %>

  </div>

  <script>
    // Delete session function
    async function deleteSession(id) {
      if (!confirm('Delete this session?')) return;
      
      try {
        const response = await fetch(`/api/session/${id}`, {
          method: 'DELETE'
        });
        
        if (response.ok) {
          location.reload();
        } else {
          alert('Error deleting session');
        }
      } catch (error) {
        console.error('Error:', error);
        alert('Error deleting session');
      }
    }
  </script>

</body>
</html>
